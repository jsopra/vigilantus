2013/11/11 07:50:15 [trace] [system.CModule] Loading "log" application component
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 07:54:40 [trace] [system.CModule] Loading "log" application component
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 07:54:40 [trace] [system.CModule] Loading "db" application component
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 07:54:40 [trace] [system.db.CDbConnection] Opening DB connection
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 07:54:40 [trace] [system.db.CDbCommand] Querying SQL: SELECT a.attname, LOWER(format_type(a.atttypid, a.atttypmod)) AS type, d.adsrc, a.attnotnull, a.atthasdef
FROM pg_attribute a LEFT JOIN pg_attrdef d ON a.attrelid = d.adrelid AND a.attnum = d.adnum
WHERE a.attnum > 0 AND NOT a.attisdropped
	AND a.attrelid = (SELECT oid FROM pg_catalog.pg_class WHERE relname=:table
		AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = :schema))
ORDER BY a.attnum
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 07:54:40 [trace] [system.db.CDbCommand] Executing SQL: CREATE TABLE "tbl_migration" (
	"version" character varying (255) NOT NULL PRIMARY KEY,
	"apply_time" integer
)
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 07:54:41 [trace] [system.db.CDbCommand] Executing SQL: INSERT INTO "tbl_migration" ("version", "apply_time") VALUES (:version, :apply_time)
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 07:54:41 [trace] [system.db.CDbCommand] Querying SQL: SELECT "version", "apply_time"
FROM "tbl_migration"
ORDER BY "version" DESC
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 07:54:42 [trace] [system.db.CDbCommand] Executing SQL: CREATE TABLE "municipios" (
	"id" serial NOT NULL PRIMARY KEY,
	"nome" varchar not null,
	"sigla_estado" varchar(2) not null,
	"nome_contato" varchar not null,
	"email_contato" varchar,
	"telefone_contato" varchar not null,
	"departamento" varchar not null,
	"cargo" varchar
)
in /home/juliano/www/dengue/protected/migrations/m131111_095015_tabela_municipio.php (16)
2013/11/11 07:54:42 [trace] [system.db.CDbCommand] Executing SQL: INSERT INTO "municipios" ("nome", "sigla_estado", "nome_contato", "email_contato", "telefone_contato", "departamento", "cargo") VALUES (:nome, :sigla_estado, :nome_contato, :email_contato, :telefone_contato, :departamento, :cargo)
in /home/juliano/www/dengue/protected/migrations/m131111_095015_tabela_municipio.php (26)
2013/11/11 07:54:42 [trace] [system.db.CDbCommand] Executing SQL: INSERT INTO "tbl_migration" ("version", "apply_time") VALUES (:version, :apply_time)
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 07:55:24 [trace] [system.CModule] Loading "log" application component
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:40:50 [trace] [system.CModule] Loading "log" application component
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:40:51 [trace] [system.CModule] Loading "db" application component
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:40:51 [trace] [system.db.CDbConnection] Opening DB connection
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:40:51 [trace] [system.db.CDbCommand] Querying SQL: SELECT a.attname, LOWER(format_type(a.atttypid, a.atttypmod)) AS type, d.adsrc, a.attnotnull, a.atthasdef
FROM pg_attribute a LEFT JOIN pg_attrdef d ON a.attrelid = d.adrelid AND a.attnum = d.adnum
WHERE a.attnum > 0 AND NOT a.attisdropped
	AND a.attrelid = (SELECT oid FROM pg_catalog.pg_class WHERE relname=:table
		AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = :schema))
ORDER BY a.attnum
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:40:51 [trace] [system.db.CDbCommand] Querying SQL: SELECT conname, consrc, contype, indkey FROM (
	SELECT
		conname,
		CASE WHEN contype='f' THEN
			pg_catalog.pg_get_constraintdef(oid)
		ELSE
			'CHECK (' || consrc || ')'
		END AS consrc,
		contype,
		conrelid AS relid,
		NULL AS indkey
	FROM
		pg_catalog.pg_constraint
	WHERE
		contype IN ('f', 'c')
	UNION ALL
	SELECT
		pc.relname,
		NULL,
		CASE WHEN indisprimary THEN
				'p'
		ELSE
				'u'
		END,
		pi.indrelid,
		indkey
	FROM
		pg_catalog.pg_class pc,
		pg_catalog.pg_index pi
	WHERE
		pc.oid=pi.indexrelid
		AND EXISTS (
			SELECT 1 FROM pg_catalog.pg_depend d JOIN pg_catalog.pg_constraint c
			ON (d.refclassid = c.tableoid AND d.refobjid = c.oid)
			WHERE d.classid = pc.tableoid AND d.objid = pc.oid AND d.deptype = 'i' AND c.contype IN ('u', 'p')
	)
) AS sub
WHERE relid = (SELECT oid FROM pg_catalog.pg_class WHERE relname=:table
	AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace
	WHERE nspname=:schema))
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:40:52 [trace] [system.db.CDbCommand] Querying SQL: SELECT attnum, attname FROM pg_catalog.pg_attribute WHERE
	attrelid=(
		SELECT oid FROM pg_catalog.pg_class WHERE relname=:table AND relnamespace=(
			SELECT oid FROM pg_catalog.pg_namespace WHERE nspname=:schema
		)
	)
    AND attnum IN (1)
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:40:52 [trace] [system.db.CDbCommand] Querying SQL: SELECT "version", "apply_time"
FROM "tbl_migration"
ORDER BY "version" DESC
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:42:46 [trace] [system.CModule] Loading "log" application component
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:42:46 [trace] [system.CModule] Loading "db" application component
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:42:46 [trace] [system.db.CDbConnection] Opening DB connection
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:42:46 [trace] [system.db.CDbCommand] Querying SQL: SELECT a.attname, LOWER(format_type(a.atttypid, a.atttypmod)) AS type, d.adsrc, a.attnotnull, a.atthasdef
FROM pg_attribute a LEFT JOIN pg_attrdef d ON a.attrelid = d.adrelid AND a.attnum = d.adnum
WHERE a.attnum > 0 AND NOT a.attisdropped
	AND a.attrelid = (SELECT oid FROM pg_catalog.pg_class WHERE relname=:table
		AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = :schema))
ORDER BY a.attnum
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:42:46 [trace] [system.db.CDbCommand] Querying SQL: SELECT conname, consrc, contype, indkey FROM (
	SELECT
		conname,
		CASE WHEN contype='f' THEN
			pg_catalog.pg_get_constraintdef(oid)
		ELSE
			'CHECK (' || consrc || ')'
		END AS consrc,
		contype,
		conrelid AS relid,
		NULL AS indkey
	FROM
		pg_catalog.pg_constraint
	WHERE
		contype IN ('f', 'c')
	UNION ALL
	SELECT
		pc.relname,
		NULL,
		CASE WHEN indisprimary THEN
				'p'
		ELSE
				'u'
		END,
		pi.indrelid,
		indkey
	FROM
		pg_catalog.pg_class pc,
		pg_catalog.pg_index pi
	WHERE
		pc.oid=pi.indexrelid
		AND EXISTS (
			SELECT 1 FROM pg_catalog.pg_depend d JOIN pg_catalog.pg_constraint c
			ON (d.refclassid = c.tableoid AND d.refobjid = c.oid)
			WHERE d.classid = pc.tableoid AND d.objid = pc.oid AND d.deptype = 'i' AND c.contype IN ('u', 'p')
	)
) AS sub
WHERE relid = (SELECT oid FROM pg_catalog.pg_class WHERE relname=:table
	AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace
	WHERE nspname=:schema))
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:42:46 [trace] [system.db.CDbCommand] Querying SQL: SELECT attnum, attname FROM pg_catalog.pg_attribute WHERE
	attrelid=(
		SELECT oid FROM pg_catalog.pg_class WHERE relname=:table AND relnamespace=(
			SELECT oid FROM pg_catalog.pg_namespace WHERE nspname=:schema
		)
	)
    AND attnum IN (1)
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:42:46 [trace] [system.db.CDbCommand] Querying SQL: SELECT "version", "apply_time"
FROM "tbl_migration"
ORDER BY "version" DESC
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:42:47 [trace] [system.db.CDbCommand] Executing SQL: CREATE TABLE "usuario_roles" (
	"id" serial NOT NULL PRIMARY KEY,
	"nome" varchar not null
)
in /home/juliano/www/dengue/protected/migrations/m131111_095524_tabela_usuario.php (10)
2013/11/11 12:42:47 [trace] [system.db.CDbCommand] Executing SQL: INSERT INTO "usuario_roles" ("nome") VALUES (:nome)
in /home/juliano/www/dengue/protected/migrations/m131111_095524_tabela_usuario.php (12)
2013/11/11 12:42:47 [trace] [system.db.CDbCommand] Executing SQL: INSERT INTO "usuario_roles" ("nome") VALUES (:nome)
in /home/juliano/www/dengue/protected/migrations/m131111_095524_tabela_usuario.php (13)
2013/11/11 12:42:47 [trace] [system.db.CDbCommand] Executing SQL: INSERT INTO "usuario_roles" ("nome") VALUES (:nome)
in /home/juliano/www/dengue/protected/migrations/m131111_095524_tabela_usuario.php (14)
2013/11/11 12:42:47 [trace] [system.db.CDbCommand] Executing SQL: INSERT INTO "usuario_roles" ("nome") VALUES (:nome)
in /home/juliano/www/dengue/protected/migrations/m131111_095524_tabela_usuario.php (15)
2013/11/11 12:42:47 [trace] [system.db.CDbCommand] Executing SQL: CREATE TABLE "usuarios" (
	"id" serial NOT NULL PRIMARY KEY,
	"nome" varchar not null,
	"login" varchar not null,
	"senha" varchar not null,
	"sal" varchar not null,
	"municipio_id" integer references municipio(id),
	"usuario_role_id" integer not null references usuario_roles(id),
	"ultimo_login" timestamp with time zone,
	"email" varchar not null,
	"token_recupera_senha" varchar,
	"data_recupera_senha" timestamp with time zone,
	"excluido" boolean not null DEFAULT false
)
in /home/juliano/www/dengue/protected/migrations/m131111_095524_tabela_usuario.php (30)
2013/11/11 12:42:48 [trace] [system.CModule] Loading "coreMessages" application component
in /home/juliano/www/dengue/protected/migrations/m131111_095524_tabela_usuario.php (30)
2013/11/11 12:42:48 [error] [system.db.CDbCommand] Falha ao executar CDbCommand::execute(): SQLSTATE[42P01]: Undefined table: 7 ERROR:  relation "municipio" does not exist. A declaração SQL executada foi: CREATE TABLE "usuarios" (
	"id" serial NOT NULL PRIMARY KEY,
	"nome" varchar not null,
	"login" varchar not null,
	"senha" varchar not null,
	"sal" varchar not null,
	"municipio_id" integer references municipio(id),
	"usuario_role_id" integer not null references usuario_roles(id),
	"ultimo_login" timestamp with time zone,
	"email" varchar not null,
	"token_recupera_senha" varchar,
	"data_recupera_senha" timestamp with time zone,
	"excluido" boolean not null DEFAULT false
).
in /home/juliano/www/dengue/protected/migrations/m131111_095524_tabela_usuario.php (30)
2013/11/11 12:42:48 [error] [exception.CDbException] exception 'CDbException' with message 'CDbCommand falhou ao executar o comando SQL: SQLSTATE[42P01]: Undefined table: 7 ERROR:  relation "municipio" does not exist. The SQL statement executed was: CREATE TABLE "usuarios" (
	"id" serial NOT NULL PRIMARY KEY,
	"nome" varchar not null,
	"login" varchar not null,
	"senha" varchar not null,
	"sal" varchar not null,
	"municipio_id" integer references municipio(id),
	"usuario_role_id" integer not null references usuario_roles(id),
	"ultimo_login" timestamp with time zone,
	"email" varchar not null,
	"token_recupera_senha" varchar,
	"data_recupera_senha" timestamp with time zone,
	"excluido" boolean not null DEFAULT false
)' in /home/juliano/www/dengue/protected/framework/db/CDbCommand.php:354
Stack trace:
#0 /home/juliano/www/dengue/protected/framework/db/CDbCommand.php(1251): CDbCommand->execute()
#1 /home/juliano/www/dengue/protected/framework/db/CDbMigration.php(229): CDbCommand->createTable('usuarios', Array, NULL)
#2 /home/juliano/www/dengue/protected/migrations/m131111_095524_tabela_usuario.php(30): CDbMigration->createTable('usuarios', Array)
#3 /home/juliano/www/dengue/protected/framework/cli/commands/MigrateCommand.php(362): m131111_095524_tabela_usuario->up()
#4 /home/juliano/www/dengue/protected/framework/cli/commands/MigrateCommand.php(100): MigrateCommand->migrateUp('m131111_095524_...')
#5 [internal function]: MigrateCommand->actionUp(Array)
#6 /home/juliano/www/dengue/protected/framework/console/CConsoleCommand.php(141): ReflectionMethod->invokeArgs(Object(MigrateCommand), Array)
#7 /home/juliano/www/dengue/protected/framework/console/CConsoleCommandRunner.php(65): CConsoleCommand->run(Array)
#8 /home/juliano/www/dengue/protected/framework/console/CConsoleApplication.php(91): CConsoleCommandRunner->run(Array)
#9 /home/juliano/www/dengue/protected/framework/base/CApplication.php(162): CConsoleApplication->processRequest()
#10 /home/juliano/www/dengue/protected/framework/yiic.php(33): CApplication->run()
#11 /home/juliano/www/dengue/protected/yiic.php(7): require_once('/home/juliano/w...')
#12 /home/juliano/www/dengue/protected/yiic(4): require_once('/home/juliano/w...')
#13 {main}
---
2013/11/11 12:42:48 [trace] [system.CModule] Loading "errorHandler" application component
2013/11/11 12:43:01 [trace] [system.CModule] Loading "log" application component
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:43:01 [trace] [system.CModule] Loading "db" application component
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:43:01 [trace] [system.db.CDbConnection] Opening DB connection
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:43:01 [trace] [system.db.CDbCommand] Querying SQL: SELECT a.attname, LOWER(format_type(a.atttypid, a.atttypmod)) AS type, d.adsrc, a.attnotnull, a.atthasdef
FROM pg_attribute a LEFT JOIN pg_attrdef d ON a.attrelid = d.adrelid AND a.attnum = d.adnum
WHERE a.attnum > 0 AND NOT a.attisdropped
	AND a.attrelid = (SELECT oid FROM pg_catalog.pg_class WHERE relname=:table
		AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = :schema))
ORDER BY a.attnum
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:43:01 [trace] [system.db.CDbCommand] Querying SQL: SELECT conname, consrc, contype, indkey FROM (
	SELECT
		conname,
		CASE WHEN contype='f' THEN
			pg_catalog.pg_get_constraintdef(oid)
		ELSE
			'CHECK (' || consrc || ')'
		END AS consrc,
		contype,
		conrelid AS relid,
		NULL AS indkey
	FROM
		pg_catalog.pg_constraint
	WHERE
		contype IN ('f', 'c')
	UNION ALL
	SELECT
		pc.relname,
		NULL,
		CASE WHEN indisprimary THEN
				'p'
		ELSE
				'u'
		END,
		pi.indrelid,
		indkey
	FROM
		pg_catalog.pg_class pc,
		pg_catalog.pg_index pi
	WHERE
		pc.oid=pi.indexrelid
		AND EXISTS (
			SELECT 1 FROM pg_catalog.pg_depend d JOIN pg_catalog.pg_constraint c
			ON (d.refclassid = c.tableoid AND d.refobjid = c.oid)
			WHERE d.classid = pc.tableoid AND d.objid = pc.oid AND d.deptype = 'i' AND c.contype IN ('u', 'p')
	)
) AS sub
WHERE relid = (SELECT oid FROM pg_catalog.pg_class WHERE relname=:table
	AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace
	WHERE nspname=:schema))
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:43:01 [trace] [system.db.CDbCommand] Querying SQL: SELECT attnum, attname FROM pg_catalog.pg_attribute WHERE
	attrelid=(
		SELECT oid FROM pg_catalog.pg_class WHERE relname=:table AND relnamespace=(
			SELECT oid FROM pg_catalog.pg_namespace WHERE nspname=:schema
		)
	)
    AND attnum IN (1)
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:43:01 [trace] [system.db.CDbCommand] Querying SQL: SELECT "version", "apply_time"
FROM "tbl_migration"
ORDER BY "version" DESC
in /home/juliano/www/dengue/protected/yiic.php (7)
2013/11/11 12:43:02 [trace] [system.db.CDbCommand] Executing SQL: CREATE TABLE "usuarios" (
	"id" serial NOT NULL PRIMARY KEY,
	"nome" varchar not null,
	"login" varchar not null,
	"senha" varchar not null,
	"sal" varchar not null,
	"municipio_id" integer references municipios(id),
	"usuario_role_id" integer not null references usuario_roles(id),
	"ultimo_login" timestamp with time zone,
	"email" varchar not null,
	"token_recupera_senha" varchar,
	"data_recupera_senha" timestamp with time zone,
	"excluido" boolean not null DEFAULT false
)
in /home/juliano/www/dengue/protected/migrations/m131111_095524_tabela_usuario.php (22)
2013/11/11 12:43:02 [trace] [system.db.CDbCommand] Executing SQL: INSERT INTO "usuarios" ("nome", "login", "senha", "sal", "usuario_role_id", "email") VALUES (:nome, :login, :senha, :sal, :usuario_role_id, :email)
in /home/juliano/www/dengue/protected/migrations/m131111_095524_tabela_usuario.php (33)
2013/11/11 12:43:02 [trace] [system.db.CDbCommand] Executing SQL: INSERT INTO "tbl_migration" ("version", "apply_time") VALUES (:version, :apply_time)
in /home/juliano/www/dengue/protected/yiic.php (7)
